{% load i18n %}
<table class="table edit" id="deals">	
    <tbody>    	
    	<tr>
      	          	
        </tr>
        <tr>
        	<td>                        
                {{opendeals_add_form.open_deal_template.label}}:
            </td>        	
            <td>                
            	<div class="input-append">
	        		{{opendeals_add_form.open_deal_template}}            	          
	            	<button type="button" id="add_opendeals_button" class="btn btn-success"><icon class="icon-white">{% trans 'Add' %}</icon></button>
            	</div>
            	<div id="contact_id" class="hidden">{{contact_id}}</div>
            </td>        	            	
        </tr>    
        <tr class="hidden">
        	<td id="X" class="hidden">
        		{{extra_deal_formset.management_form}}
        		{% for fs in extra_deal_formset%}
        			{{fs.id}} 
        			<div>       			
					<table>
						<tbody>
							<tr>
								<td>
									{{fs.DELETE.label}}:
								</td>
			                    <td>
		                    		{{fs.DELETE}}
		                    	</td>
	                    	</tr>
						</tbody>
					</table>
					<table class="table no_border_table table-condensed">
						<thead>
							<tr>								
			                    <th> 
									{% if  fs.deal_instance_name.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.deal_instance_name.label}}: *</div>{%else%}{{fs.deal_instance_name.label}}:{% endif %}                       
			                    </th>
			                    <th>          
									{% if  fs.deal_description.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.deal_description.label}}: *</div>{%else%}{{fs.deal_description.label}}:{% endif %}              
			                    </th>
			                    <th>
			                    	{% if  fs.sales_item.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.sales_item.label}}: *</div>{%else%}{{fs.sales_item.label}}:{% endif %}
			                    </th>
		                    </tr>					                                      
						</thead>									
						<tbody>
							<tr class="hidden">										
								<td>											
									{{fs.attached_open_deal_id}}		
									{{fs.is_last_active_tab}}																	
								</td>
							</tr>									
		                    <tr>		                    	
		                    	<td>				                	
				                	{{fs.deal_instance_name}}
				                	<div class="hide field field_error">{% trans 'This field is required.' %}</div>				                	               	
			                    </td>
			                    <td>
			                    	{{fs.deal_description}}				                					                    	
			                    </td>	
			                    <td>
			                    	{{fs.sales_item}}
				                	<div class="hide field field_error">{% trans 'This field is required.' %}</div>	
			                    </td>					                    					                    
		                    </tr>					                    
	                    </tbody>
						<thead>
							<tr>
								<th>    
									{% if  fs.status.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.status.label}}: *</div>{%else%}{{fs.status.label}}:{% endif %}                    
			                    </th>								
			                    <th>
									{% if  fs.sales_term.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.sales_term.label}}: *</div>{%else%}{{fs.sales_term.label}}:{% endif %}                       
			                    </th>								
			                    <th>   
									{% if  fs.currency.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.currency.label}}: *</div>{%else%}{{fs.currency.label}}:{% endif %}
			                    </th>
		                    </tr>					                    
						</thead>
						<tbody>
							<tr>
								<td>
									{{fs.status}}					                		
				                	<div class="hide field field_error">{% trans 'This field is required.' %}</div>		                    					                    	
			                    </td>								
			                    <td>
			                		{{fs.sales_term}}
									<div class="hide field field_error">{% trans 'This field is required.' %}</div>				                    	
			                    </td>
			                    <td>
									{{fs.currency}}
				                	<div class="hide field field_error">{% trans 'This field is required.' %}</div>				                    				                    	
			                    </td>								
		                    </tr>					                    
						</tbody>
						<thead>
							<tr>
								<th>
			                        {% if  fs.quantity.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.quantity.label}}: *</div>{%else%}{{fs.quantity.label}}:{% endif %}
			                    </th>
			                    <th>
								 	{% if  fs.price.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.price.label}}: *</div>{%else%}{{fs.price.label}}:{% endif %}                       
			                    </th>
			                    <th> 
			                    	{% if  fs.total_price.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.total_price.label}}: *</div>{%else%}{{fs.total_price.label}}:{% endif %}   		                    		                   
			                    </th>
		                    </tr>
						</thead>
						<tbody>
							<tr>
								<td>			                    	
				                	{{fs.quantity}}
				                	<div class="hide field field_error">{% trans 'This field is required.' %}</div>				                    	
			                    </td>
			                    <td>
			                		{{fs.price}}
									<div class="hide field field_error">{% trans 'This field is required.' %}</div>  			                    	
			                    </td>
			                    <td>                       
									{{fs.total_price}}
				                	<div class="hide field field_error">{% trans 'This field is required.' %}</div>
			                    </td>
		                    	<td class="hidden">                        
			                        {{fs.deal_template}}
			                    </td>
		                    </tr>
						</tbody>								
					</table>  
        			</div>
        		{% endfor %}
        	</td>
        </tr>    
        <tr>
        	{{ attached_deals_formset.management_form }}
			{% if attached_deals_formset %}
				<td colspan="6">
					<ul id="attached_deals_tab" class="nav nav-tabs">
					{% for fs in attached_deals_formset %}
						{{ fs.id }}						
						<li class="{% if fs.is_last_active_tab.value%}active{% endif %}{% if fs.errors %} field field_error{%endif%}">							
							<a href="#{% if fs.attached_open_deal_id.value or fs.instance.pk %}{{fs.deal_instance_name.value|slugify}}{% else %}{{fs.deal_template_name.value|slugify}}{%endif%}" data-toggle="tab">{% if fs.attached_open_deal_id.value or fs.instance.pk %}{{fs.deal_instance_name.value}}{% else %}{{fs.deal_template_name.value}}{%endif%}</a>
						</li>					
					{% endfor %}
					</ul>	
					<div class="deal_tab-content tab-content" id='tab-content'>
						{% for fs in attached_deals_formset %}
						{{ fs.id }}							
							<div class="tab-pane {% if fs.is_last_active_tab.value%}active{% endif %}" id="{% if fs.attached_open_deal_id.value or fs.instance.pk %}{{fs.deal_instance_name.value|slugify}}{% else %}{{fs.deal_template_name.value|slugify}}{%endif%}">								
								<div>
								<table>
									<tbody>
										<tr>
											<td>
												{{fs.DELETE.label}}:
											</td>
						                    <td>
					                    		{{fs.DELETE}}
					                    	</td>
				                    	</tr>
									</tbody>
								</table>
								<table class="table no_border_table table-condensed">
									<thead>
										<tr>
											<th>												
												{% if  fs.deal_instance_name.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.deal_instance_name.label}}: *</div>{%else%}{{fs.deal_instance_name.label}}:{% endif %}                        
						                    </th>
						                    <th> 
												{% if  fs.deal_description.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.deal_description.label}}: *</div>{%else%}{{fs.deal_description.label}}:{% endif %}                       
						                    </th>
						                    <th>          
											    {% if  fs.sales_item.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.sales_item.label}}: *</div>{%else%}{{fs.sales_item.label}}:{% endif %}             
						                    </th>
					                    </tr>					                                      
									</thead>									
									<tbody>
										<tr class="hidden">										
											<td>											
												{{fs.attached_open_deal_id}}		
												{{fs.is_last_active_tab}}																	
											</td>
										</tr>									
					                    <tr>
					                    	<td>							                	
							                	{{fs.deal_instance_name}}
							                	<div class="hide field field_error">{% trans 'This field is required.' %}</div>							                	
					                    	</td>
					                    	<td>
						                    	{{fs.deal_description}}							                						                    	
						                    </td>
						                    <td>
						                    	{{fs.sales_item}}
						                    	<div class="hide field field_error">{% trans 'This field is required.' %}</div>							                					                    	
						                    </td>						                    					                    
					                    </tr>					                    
				                    </tbody>
									<thead>
										<tr>
											<th>    
												{% if  fs.status.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.status.label}}: *</div>{%else%}{{fs.status.label}}:{% endif %}                    
						                    </th>											
						                    <th>
												{% if  fs.sales_term.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.sales_term.label}}: *</div>{%else%}{{fs.sales_term.label}}:{% endif %}                       
						                    </th>
						                    <th>   
												{% if  fs.currency.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.currency.label}}: *</div>{%else%}{{fs.currency.label}}:{% endif %}                    
						                    </th>											
					                    </tr>					                    
									</thead>
									<tbody>
										<tr>
											<td>
						                    	{{fs.status}}					                		
							                	<div class="hide field field_error">{% trans 'This field is required.' %}</div>   			                    	
						                    </td>											
						                    <td>
						                    	{{fs.sales_term}}
						                    	<div class="hide field field_error">{% trans 'This field is required.' %}</div>							                					                    	
						                    </td>
						                    <td>
												{{fs.currency}}						                    	
							                	<div class="hide field field_error">{% trans 'This field is required.' %}</div>							                					                    	
						                    </td>											
					                    </tr>					                    
									</tbody>
									<thead>
										<tr>
											<th>
						                        {% if  fs.quantity.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.quantity.label}}: *</div>{%else%}{{fs.quantity.label}}:{% endif %}
						                    </th>
						                    <th>
						                    	{% if  fs.price.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.price.label}}: *</div>{%else%}{{fs.price.label}}:{% endif %}
						                    </th>
						                    <th>     
					                    		{% if  fs.total_price.field.required %}<div class="cb_inline_block" rel="tooltip" title="Required Field">{{fs.total_price.label}}: *</div>{%else%}{{fs.total_price.label}}:{% endif %}                   
						                    </th>
					                    </tr>
									</thead>
									<tbody>
										<tr>
						                    <td>						                    	
							                	{{fs.quantity}}
							                	<div class="hide field field_error">{% trans 'This field is required.' %}</div>							                	
						                    </td>
						                    <td>						                    	
							                	{{fs.price}}
							                	<div class="hide field field_error">{% trans 'This field is required.' %}</div>							                				                                             
						                    </td>
						                    <td>						                    	
							                	{{fs.total_price}}							                		
						                    </td>
					                    	<td class="hidden">                        
						                        {{fs.deal_template}}
						                    </td>
					                    </tr>
									</tbody>								
								</table>  
								</div>
							</div>
						{% endfor %}										
					</div>							
				</td>				
			{% endif %}
        </tr>
    	
	</tbody>
</table>
